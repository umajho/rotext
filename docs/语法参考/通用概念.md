# 通用概念

## 阶段

Rotext 的语法分为三个阶段：[[全局阶段]]、[[块级阶段]]与[[行内阶段]]。<wbr />
Rotext 的语法规则保证解析器可以在忽略靠后阶段语法的前提下解析完成靠前阶<wbr />
段，并能在解析完成靠前阶段的基础上解析下个阶段的内容。

## 文档

一份完整的以 Rotext 写成的内容称为一份 **Rotext <ruby>文档<rt>Document<wbr />
</rt></ruby>**。[[文档]]以一条[[块级元素序列]]作为其根部。

由于 Rotext 不会拒绝任何输入，理论上任何内容都是合法的 Rotext 文档。

## 元素

**<ruby>元素<rt>Element</rt></ruby>**&#x200B;是来自于 HTML 的概念。在 <wbr />
Rotext 中，存在[[块级元素]]与[[行内元素]]。此外，还存在不属于元素但与<wbr />
[[行内元素]]平级的[[文本]]。

刨除注释，整份文档就是由[[块级元素]]、[[行内元素]]与[[文本]]堆积而成。<wbr />
[[块级元素]]可能包含[[块级元素]]、[[行内元素]]与[[文本]]，而[[行内元素]]<wbr />
之下只可能包含[[行内元素]]与[[文本]]，不可能包含[[块级元素]]。

## 槽位

**<ruby>槽位<rt>Slot</rt></ruby>**&#x200B;是[[元素]]盛放其填充内容的地<wbr />
方。不同[[元素]]拥有槽位的数量与各槽位所在位置也有所不同。有的元素固定没<wbr />
有槽位，有的元素有固定多的槽位，也有的元素有可变数量的槽位。对于最后一种<wbr />
情况，可变槽位会由[[槽位的分隔符]]分隔开。

<!--
后文在给出各[[元素]]的语法形式时，会用形如 `<NAME:TYPE>` 这样的标记标出用<wbr />
于对应槽位的指代名称（`NAME`）与该槽位填充内容的种类（`TYPE`）。示例：在 <wbr />
`[[<页面名:行内逐字>|<显示名:行内序列>]]` 中有两个槽位，第一个槽位会被称<wbr />
作 “页面名”，填充[[行内逐字]]，第二个槽位会被称作 “显示名”，填充[[行内序列]]。
-->

### 槽位的分隔符

部分元素会使用分隔符分隔槽位。[[块级元素槽位的分隔符]]总是 `||`，<wbr />
[[行内元素槽位的分隔符]]总是 `|`。详细说明参见对应章节。

块级元素[[表格行]]中的[[表格单元格|表格数据单元格]]也使用到了 `||`，但此<wbr />
处的 `||` 实质上不是分隔符。详细说明参见对应章节。

## 逐字内容

**<ruby>逐字<rt>Verbatim</rt></ruby>内容**是指将终止界限之前的一切视为文<wbr />
本的一类槽位的填充内容。

在解析逐字内容时，需要注意[[块级元素]]与[[行内元素]]终止界限的规则存在差<wbr />
异，因此不能简单地一视同仁。

## 直属

当一个[[元素]]是另一个[[元素]]的祖先，且两者之间没有隔着其他[[元素]]，<wbr />
则所处位置较深的那个元素**直属**于另一个元素。

## 嵌入包含

**<ruby>嵌入包含<rt>Transclusion</rt></ruby>**&#x200B;是指将一份[[文档]]<wbr />
的内容置于另一份[[文档]]当中。嵌入包含可以附带参数。

## 模板

**<ruby>模板<rt>Template</rt></ruby>**&#x200B;是对 “在嵌入包含中被置于另<wbr />
一份[[文档]]中” 的那份[[文档]]的称呼。

在模板中，可以将嵌入包含附带的参数通过[[块级参数填充]]与[[行内参数填充]]<wbr />
嵌入其自身之中。

## 扩展

Rotext 中有许多功能不占用专门的标记，这些功能统一通过**扩展**实现。

## 附加信息

元素可以被附上附加信息。目前仅允许为元素附上 “类” 作为附加信息。

当存在复数个附着于同一个元素的附加数据时，它们会合并：

- 所有的类同时有效；
- 没有同名的属性，直接有效；
- 存在同名的属性，最后的那个有效。
